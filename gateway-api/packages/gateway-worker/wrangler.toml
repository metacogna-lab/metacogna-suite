name = "metacogna-gateway"
main = "src/index.js"
compatibility_date = "2024-07-01"
workers_dev = false

routes = [
  { pattern = "api.metacogna.ai/*", zone_name = "metacogna.ai" }
]

[vars]
BUILD_SERVICE_URL = "https://build.metacogna.ai"
KV_SERVICE_URL = "https://kv.metacogna.ai"
CORE_SERVICE_URL = "https://parti.metacogna.ai"
BASE_SERVICE_URL = "https://hq.metacogna.ai"
GITHUB_CLIENT_ID = "Ov23liXlcYf8bISRUay8"

# Secrets (set via `wrangler secret put ...`)
# - GATEWAY_JWT_SECRET (JWT signing)
# - GITHUB_CLIENT_SECRET (GitHub OAuth exchange)
# - NOTION_WEBHOOK_SECRET (validates Notion webhook signatures)

[[r2_buckets]]
binding = "ACCOUNTS"
bucket_name = "metacogna-accounts"

[[services]]
binding = "CORE_SERVICE"
service = "metacogna"

# [[services]]
# binding = "KV_SERVICE"
# service = "metacogna-ai-worker"

# [[services]]
# binding = "BUILD_SERVICE"
# service = "parti-supervisor"

[[services]]
binding = "BASE_SERVICE"
service = "metacogna-base"
